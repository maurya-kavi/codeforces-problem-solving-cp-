<h3><a href="https://codeforces.com/contest/2103/problem/B" target="_blank" rel="noopener noreferrer">Binary Typewriter</a></h3>

<div class="header"><div class="title">B. Binary Typewriter</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>  </p><p>You are given a binary string $$$s$$$ of length $$$n$$$ and a typewriter with two buttons: <span class="tex-font-style-tt">0</span> and <span class="tex-font-style-tt">1</span>. Initially, your finger is on the button <span class="tex-font-style-tt">0</span>. You can do the following two operations:</p><ol> <li> Press the button your finger is currently on. This will type out the character that is on the button. </li><li> Move your finger to the other button. If your finger is on button <span class="tex-font-style-tt">0</span>, move it to button <span class="tex-font-style-tt">1</span>, and vice versa. </li></ol><p>The <span class="tex-font-style-it">cost</span> of a binary string is defined as the minimum number of operations needed to type the entire string. </p><p>Before typing, you may reverse at most one substring$$$^{\text{∗}}$$$ of $$$s$$$. More formally, you can choose two indices $$$1\le l\le r\le n$$$, and reverse the substring $$$s_{l\ldots r}$$$, resulting in the new string $$$s_1s_2\ldots s_{l-1}s_rs_{r-1}\ldots s_ls_{r+1}\ldots s_n$$$. </p><p>Your task is to find the minimum possible cost among all strings obtainable by performing at most one substring reversal on $$$s$$$.</p><div class="statement-footnote"><p>$$$^{\text{∗}}$$$A string $$$a$$$ is a substring of a string $$$b$$$ if $$$a$$$ can be obtained from $$$b$$$ by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end. </p></div></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The first line of each test case contains a single integer $$$n$$$ ($$$1\le n\le 2\cdot 10^5$$$) — the length of the binary string $$$s$$$.</p><p>The second line of each test case contains a binary string $$$s_1s_2\ldots s_n$$$ ($$$s_i = \mathtt{0}$$$ or $$$s_i = \mathtt{1}$$$) — the characters of the binary string $$$s$$$.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \cdot 10^5$$$. </p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output the minimum cost of string $$$s$$$ after performing at most one substring reversal.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id006904695071790703" id="id006159906847827843" class="input-output-copier">Copy</div></div><pre id="id006904695071790703"><div class="test-example-line test-example-line-even test-example-line-0">6</div><div class="test-example-line test-example-line-odd test-example-line-1">3</div><div class="test-example-line test-example-line-odd test-example-line-1">000</div><div class="test-example-line test-example-line-even test-example-line-2">3</div><div class="test-example-line test-example-line-even test-example-line-2">111</div><div class="test-example-line test-example-line-odd test-example-line-3">3</div><div class="test-example-line test-example-line-odd test-example-line-3">011</div><div class="test-example-line test-example-line-even test-example-line-4">3</div><div class="test-example-line test-example-line-even test-example-line-4">100</div><div class="test-example-line test-example-line-odd test-example-line-5">5</div><div class="test-example-line test-example-line-odd test-example-line-5">10101</div><div class="test-example-line test-example-line-even test-example-line-6">19</div><div class="test-example-line test-example-line-even test-example-line-6">1101010010011011100</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id007989662769944026" id="id0023986052841051297" class="input-output-copier">Copy</div></div><pre id="id007989662769944026">3
4
4
4
8
29
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case, we can choose not to reverse any substrings. We can do operation $$$1$$$ three times to type <span class="tex-font-style-tt">000</span>.</p><p>In the second test case, we can choose not to reverse any substrings. We can do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">1</span>. Then, we do operation $$$1$$$ three times to type <span class="tex-font-style-tt">111</span>.</p><p>In the third test case, we can choose not to reverse any substring. We can do operation $$$1$$$ to type <span class="tex-font-style-tt">0</span>. Then, we do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">1</span>. Finally, we do operation $$$1$$$ two times to type <span class="tex-font-style-tt">11</span>, resulting in the final string <span class="tex-font-style-tt">011</span> using only $$$4$$$ operations.</p><p>In the fourth test case, we can reverse the substring $$$s_{1\ldots 3}$$$, resulting in the string <span class="tex-font-style-tt">001</span>. We can do operation $$$1$$$ two times to type <span class="tex-font-style-tt">00</span>. Then we do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">1</span>. Finally, we do operation $$$1$$$ once to type <span class="tex-font-style-tt">1</span>, resulting in the final string <span class="tex-font-style-tt">001</span> using only $$$4$$$ operations.</p><p>In the fifth test case, we can reverse the substring $$$s_{2\ldots 3}$$$, resulting in the string <span class="tex-font-style-tt">11001</span>. The cost of the string is $$$8$$$ as we can do the following sequence of operations:</p><ul> <li> Do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">1</span>. </li><li> Do operation $$$1$$$ two times to type <span class="tex-font-style-tt">11</span>. </li><li> Do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">0</span>. </li><li> Do operation $$$1$$$ two times to type <span class="tex-font-style-tt">00</span>. </li><li> Do operation $$$2$$$ to move our finger to button <span class="tex-font-style-tt">1</span>. </li><li> Do operation $$$1$$$ once to type <span class="tex-font-style-tt">1</span>. </li></ul><p>In the sixth test case, we can reverse the substring $$$s_{5\ldots 17}$$$, resulting in the string <span class="tex-font-style-tt">1101</span><span class="tex-font-style-bf">1110110010010</span><span class="tex-font-style-tt">00</span>. It can be proven that the minimum number of operations needed to type the binary string is $$$29$$$.</p></div>