<h3><a href="https://codeforces.com/contest/1676/problem/G" target="_blank" rel="noopener noreferrer">White-Black Balanced Subtrees</a></h3>

<div class="header"><div class="title">G. White-Black Balanced Subtrees</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>You are given a rooted tree consisting of $$$n$$$ vertices numbered from $$$1$$$ to $$$n$$$. The root is vertex $$$1$$$. There is also a string $$$s$$$ denoting the color of each vertex: if $$$s_i = \texttt{B}$$$, then vertex $$$i$$$ is black, and if $$$s_i = \texttt{W}$$$, then vertex $$$i$$$ is white.</p><p>A subtree of the tree is called balanced if the number of white vertices equals the number of black vertices. Count the number of balanced subtrees.</p><p>A <span class="tex-font-style-it">tree</span> is a connected undirected graph without cycles. A <span class="tex-font-style-it">rooted tree</span> is a tree with a selected vertex, which is called the <span class="tex-font-style-it">root</span>. In this problem, all trees have root $$$1$$$.</p><p>The tree is specified by an array of parents $$$a_2, \dots, a_n$$$ containing $$$n-1$$$ numbers: $$$a_i$$$ is the parent of the vertex with the number $$$i$$$ for all $$$i = 2, \dots, n$$$. The parent of a vertex $$$u$$$ is a vertex that is the next vertex on a simple path from $$$u$$$ to the root.</p><p>The <span class="tex-font-style-it">subtree</span> of a vertex $$$u$$$ is the set of all vertices that pass through $$$u$$$ on a simple path to the root. For example, in the picture below, $$$7$$$ is in the subtree of $$$3$$$ because the simple path $$$7 \to 5 \to 3 \to 1$$$ passes through $$$3$$$. Note that a vertex is included in its subtree, and the subtree of the root is the entire tree.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/e509459f3f810b983691ac617992e01bad9c1559.png" style="zoom: 30.0%;max-width: 100.0%;max-height: 100.0%;"> The picture shows the tree for $$$n=7$$$, $$$a=[1,1,2,3,3,5]$$$, and $$$s=\texttt{WBBWWBW}$$$. The subtree at the vertex $$$3$$$ is balanced. </center></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains an integer $$$t$$$ ($$$1 \le t \le 10^4$$$) — the number of test cases.</p><p>The first line of each test case contains an integer $$$n$$$ ($$$2 \le n \le 4000$$$) — the number of vertices in the tree.</p><p>The second line of each test case contains $$$n-1$$$ integers $$$a_2, \dots, a_n$$$ ($$$1 \le a_i < i$$$) — the parents of the vertices $$$2, \dots, n$$$.</p><p>The third line of each test case contains a string $$$s$$$ of length $$$n$$$ consisting of the characters $$$\texttt{B}$$$ and $$$\texttt{W}$$$ — the coloring of the tree.</p><p>It is guaranteed that the sum of the values $$$n$$$ over all test cases does not exceed $$$2 \cdot 10^5$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output a single integer — the number of balanced subtrees.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id006538376547742385" id="id0003455735804595339" class="input-output-copier">Copy</div></div><pre id="id006538376547742385"><div class="test-example-line test-example-line-even test-example-line-0">3</div><div class="test-example-line test-example-line-odd test-example-line-1">7</div><div class="test-example-line test-example-line-odd test-example-line-1">1 1 2 3 3 5</div><div class="test-example-line test-example-line-odd test-example-line-1">WBBWWBW</div><div class="test-example-line test-example-line-even test-example-line-2">2</div><div class="test-example-line test-example-line-even test-example-line-2">1</div><div class="test-example-line test-example-line-even test-example-line-2">BW</div><div class="test-example-line test-example-line-odd test-example-line-3">8</div><div class="test-example-line test-example-line-odd test-example-line-3">1 2 3 4 5 6 7</div><div class="test-example-line test-example-line-odd test-example-line-3">BWBWBWBW</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id006669755909965763" id="id0003164796801140968" class="input-output-copier">Copy</div></div><pre id="id006669755909965763">2
1
4
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The first test case is pictured in the statement. Only the subtrees at vertices $$$2$$$ and $$$3$$$ are balanced.</p><p>In the second test case, only the subtree at vertex $$$1$$$ is balanced.</p><p>In the third test case, only the subtrees at vertices $$$1$$$, $$$3$$$, $$$5$$$, and $$$7$$$ are balanced.</p></div>